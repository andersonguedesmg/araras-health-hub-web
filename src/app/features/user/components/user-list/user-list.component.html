<app-breadcrumb [itemsBreadcrumb]="itemsBreadcrumb"></app-breadcrumb>

<div class="container mx-auto">
  <div class="card mt-10">
    <p-toast />
    <p-toolbar>
      <ng-template #start>
        <span class="text-xl font-bold mt-2 mb-2">Usuários</span>
      </ng-template>

      <ng-template #end></ng-template>
    </p-toolbar>

    <p-table
      #dt
      [value]="users"
      [rows]="5"
      [rowsPerPageOptions]="[5, 10, 25]"
      [columns]="cols"
      [paginator]="true"
      [globalFilterFields]="[
        'id',
        'name',
        'password',
        'function',
        'phone',
        'accessLevel',
        'isActive'
      ]"
      [tableStyle]="{ 'min-width': '75rem' }"
      [(selection)]="selectedUser"
      [rowHover]="true"
      dataKey="id"
      currentPageReportTemplate="Mostrando {first} a {last} dos {totalRecords} Registros"
      [showCurrentPageReport]="true"
    >
      <ng-template #caption>
        <div class="flex items-center justify-between">
          <p-iconfield>
            <p-inputicon styleClass="pi pi-search" />
            <input
              pInputText
              type="text"
              (input)="dt.filterGlobal($any($event.target).value, 'contains')"
              placeholder="Pesquisar..."
            />
          </p-iconfield>
          <div>
            <p-button label="Novo" icon="pi pi-plus" class="mr-2" />
            <p-button
              label="Exportar"
              icon="pi pi-upload"
              severity="secondary"
              (onClick)="exportCSV()"
            />
          </div>
        </div>
      </ng-template>

      <ng-template #header>
        <tr>
          <th style="min-width: 5rem" pSortableColumn="id">ID</th>
          <th style="min-width: 20rem" pSortableColumn="name">NOME</th>
          <th style="min-width: 15rem" pSortableColumn="password">SENHA</th>
          <th style="min-width: 20rem" pSortableColumn="function">FUNÇÃO</th>
          <th style="min-width: 12rem" pSortableColumn="phone">TELEFONE</th>
          <th style="min-width: 12rem" pSortableColumn="accessLevel">TIPO</th>
          <th style="min-width: 8rem" pSortableColumn="isActive">STATUS</th>
          <th style="min-width: 10rem">AÇÕES</th>
        </tr>
      </ng-template>

      <ng-template #body let-user>
        <tr>
          <td>{{ user.id }}</td>
          <td>{{ user.name }}</td>
          <td>{{ user.password }}</td>
          <td>{{ user.function }}</td>
          <td>{{ user.phone }}</td>
          <td>
            <p-tag
              [value]="user.accessLevel"
              [severity]="getAccessLevel(user.accessLevel)"
            />
          </td>
          <td>
            <p-tag
              [value]="getStatus(user.isActive)"
              [severity]="getSeverity(user.isActive)"
            />
          </td>
          <td>
            <p-button
              icon="pi pi-pencil"
              class="mr-2"
              [rounded]="true"
              [outlined]="true"
            />
            <p-button
              icon="pi pi-trash"
              severity="danger"
              [rounded]="true"
              [outlined]="true"
            />
          </td>
        </tr>
      </ng-template>
    </p-table>
  </div>
</div>
